<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>working_with_text</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="working_with_text_files/libs/clipboard/clipboard.min.js"></script>
<script src="working_with_text_files/libs/quarto-html/quarto.js"></script>
<script src="working_with_text_files/libs/quarto-html/popper.min.js"></script>
<script src="working_with_text_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="working_with_text_files/libs/quarto-html/anchor.min.js"></script>
<link href="working_with_text_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="working_with_text_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="working_with_text_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="working_with_text_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="working_with_text_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="working_with_text_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="working_with_text_files/libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet">
<script src="working_with_text_files/libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="working_with_text_files/libs/wordcloud2-0.0.1/hover.js"></script>
<script src="working_with_text_files/libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">working_with_text</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>First, install the packages you will likely need to conduct the text analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="text-analysis" class="level1">
<h1>Text analysis</h1>
<p>In this tutorial we are going to start working with the text that we scraped last time. We will take the tidy approach to text analysis because it is fairly intuitive in that it treats text as data frames for analysis.</p>
<p>Furthermore, the text converted into a data frame can be converted to a variety of formats that allow it to be analyzed by other popular ra programs such as quanteda. While the examples are different and we won’t cover all of the topics in the book you can find much of this material in <a href="https://www.tidytextmining.com/index.html" title="A Tidy Approach"><strong>Text Mining with R</strong></a><strong>: A Tidy Approach</strong> listed in the syllabus</p>
<p>This image from <a href="https://www.tidytextmining.com/index.html" title="A Tidy Approach"><strong>Text Mining with R</strong></a><strong>: A Tidy Approach</strong> demonstrates the general overall process for text analysis using tidyverse:</p>
<p><img src="Images/2.png" class="img-fluid"></p>
<section id="a-corpus" class="level2">
<h2 class="anchored" data-anchor-id="a-corpus">A Corpus</h2>
<p>For our analysis we need text. The raw text is the corpus that we work on. The corpus that we are interested in varies depending on our research objectives. For example, a corpus can contain a newspaper article, multiple articles, tweets about a particular topic or from a group of people. How we put together the relevant corpus depends on the objective of our analysis.</p>
<p>ADD A SECTION ABOUT CREATING A CORPUS (USING PDFS AND THINGS)</p>
<p>As an example, here we will use the newspaper article that we scraped.</p>
<p>The first step is to load the data that we saved in the last project. It was saved as an R Object, so we can load it the following way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"multiple_url_paragraphs.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This loads the saved R data object into our working environment to allow us to begin working with the data. As you can see, it’s loaded as what we saved the object as previously, multi_df.</p>
</section>
<section id="cleaning-the-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-data">Cleaning the Data</h2>
<p>We now need to work on cleaning the data to render it into a format that we can use for text analysis. For this tutorial, we will be using the tidyverse text analysis method so begin by loading the tidytext package and installing it if not installed yet. This will be one of the core packages needed for our work.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidytext")</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can begin to work with the data and transform it into something usable.</p>
<p>Begin by tokenizing the data, or separating the paragraphs and sentences into words instead of the format they are currently in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tidy_paragraphs <span class="ot">&lt;-</span> multi_df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we look at tidy_paragraphs, we can see that the text is broken down by word and noted by the paragraph it is found in:</p>
<p><img src="Images/1.png" class="img-fluid"></p>
<p>Now we want to begin cleaning the corpus by removing unnecessary words. These are words that convey no meaningful information but appear frequently, usually referred to as “stop words” such as but, and, if, then, and similar words.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tidy_paragraphs <span class="ot">&lt;-</span> tidy_paragraphs <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "word"</code></pre>
</div>
</div>
<p>This uses the “stop words” dataset from tidyverse to remove the most common stop words.</p>
<p>ADD IN CLEANING THAT ISN’T JUST STOP WORDS</p>
<p>We can then look at the top words using the following function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tidy_paragraphs <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This shows that the top words in these articles, with stop words removed, are Munich, western, Ukraine, war, countries, and Germany.</p>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<p>The most commonly used words can be visualized using a word cloud. Two packages, devtools and wordcloud2, are needed to do this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud2)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: usethis</code></pre>
</div>
</div>
<p>First, we must figure out the word counts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>t_para <span class="ot">&lt;-</span> tidy_paragraphs <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can make a very simple wordcloud using the wordcloud2() function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud2</span>(t_para)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-2cb5343f8e622b130078" style="width:100%;height:464px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-2cb5343f8e622b130078">{"x":{"word":["munich","western","ukraine","war","countries","germany","central","europe","president","tanks","zelenskyy","european","russian","scholz","security","support","ukraine’s","allies","defense","german","policy","2","chancellor","conference","europeans","history","leopard","military","ukrainian","account","alternative","berlin","country","goliath","historical","intelligence","lose","morawiecki","nato","partners","putin","russia","russia’s","there’s","u.s","acceptance","access","actionable","alliance","confirm","conflict","content","data","depth","forgot","invasion","join","kyiv","leaders","log","logging","manage","opportunity","password","politico","press","privacy","professionals","profile","register","reporters","reporting","send","sending","speed","tank","vladimir","warned","west","added","alliances","austin","baltics","battle","begun","belarus","belarusian","biblical","boot","calling","commit","compared","conferences","counterparts","crucial","cycles","david","defeat","deliver","donations","drawn","east","economic","election","enthusiastic","eu","event","fear","fight","friday","gathering","global","including","informed","international","involved","kuisz","minister","modern","neighbors","officials","past","percent","pistorius","poles","political","process","recent","remarks","responsibility","shared","sling","soviet","spending","start","strength","stretching","they’ve","told","training","trap","union","unity","urging","volodymyr","win","world","100","1938","80","85","a4","a6","acceleration","acknowledges","adding","adhere","administration","admit","adversaries","ages","ago","agreed","agreement","ahead","air","alarm","alexander","align","annual","anxiety","anxious","appeasement","appetite","applause","arbitrarily","aren’t","article","artificial","artillery","asleep","attacked","audience","barely","based","battlefield","betrayal","betting","bid","biden’s","billion","boost","boris","bound","bring","britain’s","bucha","build","built","bulgaria","bullying","buts","cajoling","call","campaign","can’t","cautious","centuries","challenge","chamberlain","changing","chiefs","churning","closed","cohesion","cohort","commissars","commitment","compassion","conclusion","concretely","congress","considerable","contact","contrast","convince","counting","country’s","cultural","czars","czechs","daladier","danger","date","day","days","decision","definitive","delivering","desk","determined","devastatingly","diplomacy","direction","dismissed","display","don’t","drag","dragging","drive","driven","dubious","duty","earnest","ease","easier","eastern","easy","editor","édouard","education","embrace","empathy","ensure","entitled","entrapped","escaped","established","estonia","eventually","exception","exit","expect","experience","explain","expressly","extended","fall","families","feet","fighting","finally","finland","fleeing","fleet","focus","focused","fold","follow","forces","forums","founded","founder","france’s","freedom","friends","frozen","fulfill","fund","future","gains","gathered","gaze","generations","genetic","germany’s","giant","giving","goal","government","grab","green","grinded","growing","haul","haunt","he’s","hesitated","highlight","historian","histories","hoped","hopes","horrors","hours","hungary","identities","ifs","impelling","industry","inextricably","infamous","influential","informing","innately","insurance","integration","intensively","interactions","interplay","interpreted","invaded","investment","iran","irpin","israelite","jarosław","joe","joining","joseph","kilometer","kitchen","kultura","leader’s","leadership","leave","led","left","lens","level","liberalna","lie","linguistic","linking","listen","lloyd","location","logistical","losses","low","lukashenko","lurch","maintains","massive","mateusz","meeting","memorialize","mention","message","miscalculation","miss","mnichovská","month","months","moral","motives","nation","negotiated","negotiations","nervousness","neville","niggling","notable","notably","noted","observers","offer","offering","olaf","olive","opposed","organize","output","partial","partnerships","passed","people","perception","permanent","permanently","perspective","philistine","play","pledge","pledges","podcast","poland","poland’s","policymakers","polish","portugal","post","potsdam","praise","predicted","preemptive","prepare","prepared","pressing","previous","primarily","prime","private","probability","proceed","production","prompted","provide","proximity","psychologists","public","pulling","purposefulness","putin’s","question","quickly","rally","ramstein","rattling","reacted","reasons","received","refugees","region","regroup","reportedly","represented","republican","reset","reshaping","response","saber","save","scandinavia","scholz’s","secretary","sense","series","set","settlement","shaping","shells","shepherd","shoulder","shown","shudder","signed","significant","sitting","size","soldiers","spain","speaking","special","speech","spilling","spoke","spurning","stalin","starts","stocks","stomach","stone","stop","story","stranglehold","strategies","strong","stronger","struggling","sudetenland","suffer","superseded","supply","supporting","survival","sweatshirt","switch","systems","tables","takes","talk","talks","target","targets","tasks","thanked","thursday","ties","time","times","tire","total","trademark","transatlantic","treatment","trepidation","trimming","troops","tuesday","ukrainians","uncompromised","underlying","underpinned","underscoring","understanding","uninvited","unshakable","urges","vanquished","version","victory","visegrád","voiced","vowed","wall","warplanes","weapons","weary","week","weekly","wide","wise","woken","won’t","worries","write","yalta","zrada"],"freq":[14,13,12,11,10,10,9,8,8,8,8,7,7,7,7,7,7,6,6,6,6,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":12.8571428571429,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
</div>
</div>
<p>This then outputs a simple wordcloud of the most commonly use words in our articles.</p>
<p>[ADD SUMMARY STATISTICS]</p>
<p>[ADD SENTIMENT ANALYSIS PORTION]</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>